# 龙与生存环境的关系

## 《冰与火之歌》世界的环境分析

### 地理

《冰与火之歌》的世界地图：

<img src="https://static.wikia.nocookie.net/asoiaf/images/f/f6/Agot_hbo_guide_map.jpg/revision/latest/scale-to-width-down/1000?cb=20120821133041&path-prefix=zh" style="zoom:50%;" />

《冰与火之歌》的世界分为三个大陆：

- 维斯特洛：坐落于已知世界的最西端，狭长的维斯特洛大陆由北部的极地冰盖起向南延绵约3,000英里。绝境长城是一座巍峨挺立的不可逾越之物，横跨300英里，将最北的塞外地区与七大王国相互分离
- 厄斯索斯：与维斯特洛大陆隔狭海相望，厄索斯由此向东延伸数千公里。它的面积大于维斯特洛，但是人口密度低于维斯特洛。大陆西部的边缘由九个自由贸易城邦统治。奴隶湾的城邦坐落于大陆的南部腹地。剩余的内陆地区被称之为多斯拉克海，由被称之为多斯拉克人的部族勇士们占据。再往东是魁尔斯和充满传奇色彩的玉海。厄索斯的最东端尚未被完全探索，但我们已知那里拥有神秘的亚夏和阴影之地
- 索斯罗斯：相对更为未知。索斯罗斯位于厄索斯南部，在夏日之海的远端。这片辽阔的大陆密布丛林与荒原，据说这里是瘟疫和猛兽的天堂，除了最北端的海岸区域，还尚未被深入探索

## 气候

《冰与火之歌》中关于气候的部分相关描述如下，我们集中分析维斯特洛大陆，因为这片大陆是小说的主角地，描述相对详细：

- 塞外：气候非常严苛、苦寒，尤其是位于极北的永冬之地

  - 类似两极地区，极地气候

- 北境：境内遍是大片的荒地、森林和白雪皑皑的高山。北境的冬季酷寒无比，甚至在夏季也可能降雪

  - 类似俄罗斯北部等地区，亚寒带针叶林气候

- 河间地：囊括了众多平原、森林、山丘，以及无数的河流

  - 虽然缺乏对气温的描述，通过植被和河流判断其类似温带海洋性气候

- 河湾地：地势开阔、灌溉便利、土壤肥沃，因而农业发达，果蔬遍野，鲜花满园，被誉为七国之粮仓

  - 虽然缺乏对气温的描述，不过农业发达的地区应该类似南亚，亚热带气候

- 风暴地：有广阔而茂密的丛林（代表地区有御林和雨林）

  - 虽然缺乏对气温的描述，然而雨林的存在说明其高温多雨，类似亚马逊等地区，热带雨林气候

- 多恩：维斯特洛最炎热的地区，它多石、多山、干旱而贫瘠，并且拥有大陆上唯一的沙漠。有河流流经的区域土地肥沃，而且即使在长夏也有足够的雨水和其他水源供给，保证多恩仍适合人类居住

  - 类似撒哈拉等地区，热带沙漠气候

虽然维斯特洛大陆形似不列颠岛，然而其气候却不同，如果将维斯特洛大陆投影到地球上，若只考虑纬度而不考虑洋流等因素，大概如下图：

<img src="https://gitee.com/koorye/picgo/raw/master/image-20210120110607516.png" alt="image-20210120110607516" style="zoom: 67%;" />

我们分别选取现实世界中不同气候区的代表地区进行分析：

- 寒带：格陵兰、阿拉斯加、南极
- 亚寒带：莫斯科
- 温带：巴黎、北京、千叶、伊斯坦布尔、加利福尼亚
- 热带：
  - 雨林：亚马逊、加里曼丹、刚果、海南
  - 沙漠：西撒哈拉

我们通过 “WheatA 小麦芽” 农业气象大数据软件，获取到以上地区的气候数据，格式如下：

| 12-2月平均温度(℃) | 12-2月降水量(mm) | 3-5月平均温度(℃) | 3-5月降水量(mm) | 6-8月平均温度(℃) | 6-8月降水量(mm) | 9-11月平均温度(℃) | 9-11月降水量(mm) | 单日最大平均风速(knots) | 平均最低气温(℃) | 平均最大持续风速(knots) | 平均最大瞬时风速(knots) | 平均最高气温(℃) | 平均气温(℃) | 平均气温≤0℃的天数 | 平均气温≥18℃的天数 | 平均气温≥35℃的天数 | 平均海平面气压(hPa) | 平均站点气压(hPa) | 平均能见度(km) | 平均露点温度(℃) | 平均风速(knots) | 年份 | 最低气温≤0℃的天数 | 最低气温极值(℃) | 最低海平面气压(hPa) | 最大单日降水量(mm) | 最大瞬时风速极值(knots) | 最大能见度(km) | 最小能见度(km) | 最高气温≥35℃的天数 | 最高气温极值(℃) | 有效天数 | 积雪深度(mm) | 站名                                      | 站点号      | 纬度      | 经度       | 降水天数 | 降水量(mm) | 高度(m) |
| ----------------- | ---------------- | ---------------- | --------------- | ---------------- | --------------- | ----------------- | ---------------- | ----------------------- | --------------- | ----------------------- | ----------------------- | --------------- | ----------- | ----------------- | ------------------ | ------------------ | ------------------- | ----------------- | -------------- | --------------- | --------------- | ---- | ----------------- | --------------- | ------------------- | ------------------ | ----------------------- | -------------- | -------------- | ------------------ | --------------- | -------- | ------------ | ----------------------------------------- | ----------- | --------- | ---------- | -------- | ---------- | ------- |
| -1.73             | 0.0              | nan              | 0.0             | nan              | 0.0             | 7.01              | 0.0              | 26.0                    | -1.57           | 10.22                   | nan                     | 9.04            | 3.68        | 14                | 0                  | 0                  | 1026.4              | 1000.39           | 91.56          | -4.2            | 3.75            | 1945 | 28                | -13.72          | 1014.3              | 0.0                | nan                     | 159.97         | 1.77           | 0                  | 20.22           | 50       | nan          | BEIJING CAPITAL INTERNATIONAL AIRPORT, CH | 54511099999 | 40.080111 | 116.584556 | 0        | 0.0        | 35.35   |
| -2.59             | 0.0              | 13.08            | 0.0             | 27.48            | 0.0             | 14.8              | 0.0              | 48.0                    | 6.77            | 12.43                   | nan                     | 18.58           | 13.27       | 83                | 157                | 0                  | 1017.74             | 1009.91           | 70.62          | 3.71            | 5.84            | 1946 | 124               | -15.89          | 996.4               | 0.0                | nan                     | 159.97         | 0.64           | 22                 | 40.72           | 365      | nan          | BEIJING CAPITAL INTERNATIONAL AIRPORT, CH | 54511099999 | 40.080111 | 116.584556 | 0        | 0.0        | 35.35   |
| -5.28             | 0.0              | 2.79             | 0.0             | nan              | 0.0             | nan               | 0.0              | 42.9                    | -7.97           | 15.15                   | nan                     | 2.82            | -2.5        | 61                | 0                  | 0                  | 1027.67             | 1019.32           | 21.76          | -11.84          | 6.72            | 1947 | 82                | -15.89          | 1004.6              | 0.0                | nan                     | 47.96          | 1.61           | 0                  | 16.28           | 90       | nan          | BEIJING CAPITAL INTERNATIONAL AIRPORT, CH | 54511099999 | 40.080111 | 116.584556 | 0        | 0.0        | 35.35   |
| -5.75             | 1.02             | nan              | 0.0             | 22.84            | 37.85           | 11.67             | 210.31           | 22.9                    | 3.46            | 7.75                    | nan                     | 13.53           | 8.83        | 38                | 38                 | 0                  | 1022.0              | 999.9             | 12.44          | 0.11            | 3.62            | 1956 | 54                | -13.89          | 1004.9              | 72.9               | nan                     | 37.18          | 1.45           | 0                  | 30.0            | 131      | nan          | BEIJING CAPITAL INTERNATIONAL AIRPORT, CH | 54511099999 | 40.080111 | 116.584556 | 34       | 249.17     | 35.35   |
| -4.0              | 24.64            | 12.19            | 50.8            | 24.41            | 361.19          | 12.32             | 53.34            | 30.9                    | 5.42            | 7.83                    | nan                     | 16.74           | 11.32       | 94                | 136                | 0                  | 1017.02             | 999.9             | 15.76          | 1.01            | 3.84            | 1957 | 139               | -17.22          | 990.0               | 70.61              | nan                     | 56.65          | 1.13           | 3                  | 36.11           | 357      | nan          | BEIJING CAPITAL INTERNATIONAL AIRPORT, CH | 54511099999 | 40.080111 | 116.584556 | 103      | 489.97     | 35.35   |

我们保留了以下部分可能有用的特征：

- 平均气温(℃)
- 降水量(mm)
- 平均海平面气压(hPa)
- 平均风速(knots)
- 平均能见度(km)
- 最低气温极值(℃)
- 最高气温极值(℃)
- 最大单日降水量(mm)
- 最大瞬时风速极值(knots)
- 最大能见度(km)
- 最小能见度(km)

并对缺失值采用均值填充，再对每个特征进行标准化处理。

由于特征过多，我们对数据使用 PCA 算法进行降维：

各成分的总方差解释如下表所示：

| 成分 | 总计  | 方差百分比 | 累积 %  |
| ---- | ----- | ---------- | ------- |
| 1    | 3.986 | 36.236     | 36.236  |
| 2    | 2.445 | 22.229     | 58.465  |
| 3    | 1.463 | 13.302     | 71.767  |
| 4    | 1.362 | 12.383     | 84.150  |
| 5    | 1.096 | 9.962      | 94.112  |
| 6    | .342  | 3.106      | 97.217  |
| 7    | .150  | 1.360      | 98.578  |
| 8    | .100  | .906       | 99.483  |
| 9    | .044  | .398       | 99.881  |
| 10   | .012  | .105       | 99.986  |
| 11   | .002  | .014       | 100.000 |

各成分的组成矩阵如下表所示：

| 成分                  | 1     | 2     | 3     | 4     | 5     |
| --------------------- | ----- | ----- | ----- | ----- | ----- |
| 平均气温              | .866  | -.266 | -.226 | .216  | .272  |
| 降水量mm              | .762  | .427  | .250  | -.327 | -.177 |
| 平均海平面气压hPa     | .114  | .259  | -.141 | .566  | -.727 |
| 平均风速knots         | -.807 | .078  | .029  | .243  | .278  |
| 平均能见度km          | .069  | .875  | .199  | .316  | .261  |
| 最低气温极值          | .797  | -.415 | -.083 | .239  | .273  |
| 最高气温极值          | .819  | -.011 | -.464 | .181  | .136  |
| 最大单日降水量mm      | .763  | .446  | .208  | -.316 | -.230 |
| 最大瞬时风速极值knots | -.119 | .455  | -.495 | -.650 | .188  |
| 最大能见度km          | -.010 | .857  | -.042 | .342  | .304  |
| 最小能见度km          | .294  | -.202 | .882  | .002  | .207  |

观察发现：第一个特征与气温、降水、风速都密切相关，它提供了超过 1/3 的信息量。可见气温、降水、风速，是影响气候的主要因素。

使用前两个特征绘制二维散点图，如下图所示：

![全球部分地区气候-PCA 后](https://gitee.com/koorye/picgo/raw/master/%E5%85%A8%E7%90%83%E9%83%A8%E5%88%86%E5%9C%B0%E5%8C%BA%E6%B0%94%E5%80%99-PCA%20%E5%90%8E.png)

气温在该图中的表现是最明显的，如下图所示，地区的气温随着红色箭头所指的方向呈现明显的逐渐降低的趋势：

![全球部分地区气候-PCA 后-2](https://gitee.com/koorye/picgo/raw/master/%E5%85%A8%E7%90%83%E9%83%A8%E5%88%86%E5%9C%B0%E5%8C%BA%E6%B0%94%E5%80%99-PCA%20%E5%90%8E-2.png)

我们查找了部分龙的生命轨迹，以探究龙适合的生存环境：

| 龙       | 出生地     | 死亡地 |
| -------- | ---------- | ------ |
| 沃米索尔 | 龙石岛     | 腾石镇 |
| 银翼     | 龙石岛     | /      |
| 海烟     | 龙石岛     | 腾石镇 |
| 偷羊贼   | 龙石岛     | /      |
| 贪食者   | 龙石岛     | /      |
| 灰影     | 龙石岛     | 龙石岛 |
| 卓耿     | 多斯拉克海 | /      |
| 雷哥     | 多斯拉克海 | /      |
| 韦赛利昂 | 多斯拉克海 | /      |
| 贝勒里恩 | 瓦雷利亚   | /      |
| 米拉西斯 | 龙石岛     | 狱门堡 |
| 叙拉克斯 | 龙石岛     | 君临   |
| 月舞     | 龙石岛     | 龙石岛 |
| 阳炎     | 龙石岛     | /      |
| 瓦格哈尔 | 龙石岛     | 神眼湖 |
| 晨光     | 海鸥镇     | /      |

地点的出现频率如下：

- 龙石岛 x 13
- 多斯拉克海 x 3
- 腾石镇 x 2
- 瓦雷利亚 x 1
- 海鸥镇 x 1
- 神眼湖 x 1
- 君临 x 1
- 狱门堡 x 1

将以上地点标注到地图上：

<img src="https://gitee.com/koorye/picgo/raw/master/%E9%BE%99%E7%9A%84%E5%88%86%E5%B8%83.jpg" alt="龙的分布" style="zoom:50%;" />

经过观察，我们发现龙分布在温带到热带地区，若以现实世界的角度来看，大概集中在 30° N ~ 40° N 之间。

我们可以在图上大致绘制出龙适合生存的地区：

- 绿色 非常适宜
- 黄色 相对适宜

![全球部分地区气候-PCA 后-3](https://gitee.com/koorye/picgo/raw/master/%E5%85%A8%E7%90%83%E9%83%A8%E5%88%86%E5%9C%B0%E5%8C%BA%E6%B0%94%E5%80%99-PCA%20%E5%90%8E-3.png)

经过之前的 PCA 处理，我们得出气温是影响气候最主要因素的结论。因此，在接下来的分析中，我们选用纬度作为研究对象。因为纬度与气温直接相关。

通过之前维斯特洛大陆在现实世界的投影，我们可以估计出《冰与火之歌》中各地点的纬度。

将之前龙的分布地点以纬度的形式绘制柱状图，如下图所示：

![龙的分布与纬度的关系](https://gitee.com/koorye/picgo/raw/master/%E9%BE%99%E7%9A%84%E5%88%86%E5%B8%83%E4%B8%8E%E7%BA%AC%E5%BA%A6%E7%9A%84%E5%85%B3%E7%B3%BB.png)

和其他动物的分布类似，我们能否认为龙的分布也服从正态分布？

通过构建 Q-Q 图，虽然由于小说的描述不够详细，样本数不足。然而我们发现：

- 散点在 Q-Q 图上仍然能呈现出线性关系
- 散点均匀分布在直线两侧

因此我们认为龙的分布服从正态分布。

<img src="https://gitee.com/koorye/picgo/raw/master/clip_image001.png" alt="img" style="zoom: 67%;" />

Q-Q 图的绘制步骤：

- 对于从小到大排列的数字序列 $(x_1,x_2,\dots,x_n)$，共有 n 个值

- 根据正态分布的累计分布函数公式
  $$
  CDF=\frac{i-a}{n+1-2a}(a的取值由自己决定，常用0.3、0.35、0.5等值)
  $$
  计算得到分位数 $1st,2nd,\dots,nth$ 的累计分布函数值 (CDF)

- 对于每一个分位数，根据 CDF 查正态分布表得到其 Z 值

- 根据公式
  $$
  x=\mu+Z\sigma
  $$
  得到每个分位数的值 x

- 将每个分位数的值 x 作为 x 轴，CDF 作为 y 轴，描出散点，将散点连成直线

- 将数字序列的每个值 $x_i$ 作为 x 轴，CDF 作为 y 轴，描出散点

采用极大似然估计法对以上数据进行拟合：

- 假设龙的分布服从正态分布，概率密度如下：
  $$
  f(x) = \frac{1}{\sqrt{2\pi}\sigma}e^-\frac{(x-\mu)^2}{2\sigma^2}
  $$
  
- 设似然函数
  $$
  L(\mu, \sigma;x)=\prod_{i=1}^{n}f(x_n)
  $$

- 求解得
  $$
  \mu=35.869565,\sigma=8.867649
  $$

正态分布曲线如下图所示：

![龙的分布与纬度的关系-高斯分布](https://gitee.com/koorye/picgo/raw/master/%E9%BE%99%E7%9A%84%E5%88%86%E5%B8%83%E4%B8%8E%E7%BA%AC%E5%BA%A6%E7%9A%84%E5%85%B3%E7%B3%BB-%E9%AB%98%E6%96%AF%E5%88%86%E5%B8%83.png)

根据 $3\sigma$ 原则，我们将

- $(\mu-\sigma,\mu+\sigma)$ 也就是 30.0° ~ 44.7° 作为最适合龙生存的纬度，龙在该区间生活的概率为 68.27%
- $(\mu-2\sigma,\mu+2\sigma)$ 也就是 18.1° ~ 53.6° 作为较适合龙生存的纬度，龙在该区间生活的概率为 95.45%