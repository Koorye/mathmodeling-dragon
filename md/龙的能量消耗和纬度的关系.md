# 龙的体重和能量消耗与纬度的关系

## 引用

王蓓, 姜文秀, 练硝,等. 高山姬鼠冷驯化过程中的能量收支[C]// 野生动物生态与资源保护第四届全国学术研讨会. 0.

在之前的计算中，我们认为龙的生存纬度服从 $\mu=35.869565,\sigma=8.867649$ 的正态分布，根据 $3\sigma$ 原则，我们认为龙的生存纬度应在 $(\mu-3\sigma,\mu+3\sigma)$ 也就是 9.2° ~ 62.5° 之间，超出该范围的纬度我们认为龙不可能生存。

接下来我们将探讨在该纬度范围内，龙的体重和能量消耗与纬度的关系。

我们认为温度与龙的能量消耗关系与其他动物类似。

将高山姬鼠分别置于室温 (10.9℃) 和冷驯化环境 (5℃) 下培养，采用食物平衡法测定动物的能量收支，测得结果如下：

<img src="https://gitee.com/koorye/picgo/raw/master/image-20210121102334779.png" alt="image-20210121102334779" style="zoom: 67%;" /><img src="https://gitee.com/koorye/picgo/raw/master/image-20210121102359418.png" alt="image-20210121102359418" style="zoom: 67%;" />

借此我们认为，随着温度的降低，龙的体重会下降，摄入能量会增加。

在该实验中，温度下降 5.9 ℃，导致体重下降到原先的 89.2%，摄入能增加到原先的 164.3%.

由于现实中跨热带、温带、寒带分布的动物非常稀少，我们通过收集鼠类在不同温度下的体重和摄入能比例来推断动物的体重、能量消耗与温度的关系。

通过收集其他实验的数据，我们得到了如下表格：

| 温度下降 (℃) (基准为 25 ℃) | 体重比例 (现体重 / 原体重) | 摄入能量比例 (现摄入能 / 原摄入能) |
| -------------------------- | -------------------------- | ---------------------------------- |
| 5                          | 0.924                      | 1.256                              |
| 10                         | 0.875                      | 1.309                              |
| 15                         | 0.842                      | 1.347                              |
| 20                         | 0.827                      | 1.467                              |
| 25                         | 0.823                      | 1.488                              |



为探索上述图像存在何种曲线关系，考虑到样本稀少，采用灰色预测模型比较合适。

灰色预测的步骤：

- 对于原始数据序列
  $$
  x^{(0)}=\{x^{(0)}(1),x^{(0)}(2),\dots,x^{(0)}(n)\}
  $$

- 对序列进行级比检验
  $$
  \lambda(k)=\frac{x^{(0)}(k-1)}{x^{(0)}(k)},k=2,3,\dots,n
  $$
  若 $\lambda(k)$ 均落在区间 $\Theta=(e^{-\frac{2}{n+1}},e^{\frac{2}{n+1}})$ 内，则可以进行 $GM(1,1)$ 型灰色预测
  
- 若级比检验不通过，则需要取适当的常数 c，使 $y^{(0)}(i)=x^{(0)}(i)+c$，使序列 $y^{(0)}$ 的级比检验通过
  
- 对数据进行累加
  $$
  x^{(1)}(1)=x^{(0)}(1) \\
  x^{(1)}(2)=x^{(0)}(1)+x^{(0)}(2) \\
  \vdots \\
  x^{(1)}(i)=\sum_{j=1}^{i}x^{(0)}(j) \\
  \vdots \\
  x^{(1)}(n)=x^{(0)}(1)+x^{(0)}(2)+\dots+x^{(0)}(n)
  $$
  得到原始数据序列的一次累加生成序列 
  $$
  x(1)=\{x^{(1)}(1),x^{(1)}(2),\dots,x^{(1)}(n)\}
  $$
  
-  令
  $$
  z^{(1)}=(z^{(1)}(2),z^{(1)}(3),\dots,z^{(1)}(n))
  $$
  为 $x^{(1)}$ 的紧邻均值生成序列，其中
  $$
  z^{(1)}(i)=0.5x^{(1)}(i)+0.5x^{(1)}(i-1),i=2,3,\dots,n
  $$

- 称灰色微分方程
  $$
  x^{(0)}(k)+az^{(1)}(k)=b,k=2,3,\dots,n
  $$
  为 GM(1,1) 模型的基本形式，其中 b 表示灰作用量，-a 表示发展系数

- 引入矩阵
  $$
  u=\begin{pmatrix}
  a \\
  b \\
  \end{pmatrix},
  Y=\begin{pmatrix}
  x^{(0)}(2) \\
  x^{(0)}(3) \\
  \vdots \\
  x^{(0)}(n) \\
  \end{pmatrix},
  B=\begin{pmatrix}
  -z^{(1)}(2) & 1 \\
  -z^{(1)}(3) & 1 \\
  \vdots & \vdots \\
  -z^{(1)}(n) & 1 \\
  \end{pmatrix}
  $$
  则灰色微分方程可表示为
  $$
  Y=Bu
  $$
  使用 OLS (最小二乘法) 估计得到参数 a,b 的估计值为
  $$
  \hat{u}=\begin{pmatrix}
  \hat{a}\\
  \hat{b}\\
  \end{pmatrix}=(B^TB)^{-1}B^TY
  $$
  
- 称
  $$
  \frac{dx^{(1)}(t)}{dt}=-\hat{a}x^{(1)}(t)+\hat{b}
  $$
  为 GM(1,1) 模型的白化方程，取 $\hat{x}^{(1)}(0)=x^{(0)}(1)$，则
  $$
  \hat{x}^{(1)}(k+1)=[x^{(0)}(1)-\frac{\hat{b}}{\hat{a}}]e^{-\hat{a}k}+\frac{\hat{b}}{\hat{a}},\\
  k=1,2,\dots,n-1
  $$
  
- 通过累减还原
  $$
  \hat{x}^{(0)}(k+1)=\hat{x}^{(1)}(k+1)-\hat{x}^{(1)}(k) \\
  =[x^{(0)}(1)-\frac{\hat{b}}{\hat{a}}](1-e^{\hat{a}})e^{-\hat{a}k}, \\
  k=1,2,\dots,n-1
  $$
  即为预测方程

- 进行后验差检验，步骤如下
$$
  残差序列 e^{(0)}(k)=x^{(0)}(k)-\hat{x}^{(0)}(k) \\
  原始序列 x^{(0)} 的方差 S_1^2=\frac1n\sum_{k=1}^n[x^{(0)}(k)-\overline{x}]^2 \\
  残差序列 e^{(0)} 的方差 S_2^2=\frac1n\sum_{k=1}^n[e(k)-\overline{e}]^2 \\
  后残差比 C=\frac{S_2}{S_1}
$$

| 模型精度等级  | 后残差比 C        |
| ------------- | ----------------- |
| 1 级 (好)     | $C\le0.35$        |
| 2 级 (合格)   | $0.35\lt C\le0.5$ |
| 3 级 (勉强)   | $0.5\lt C\le0.65$ |
| 4 级 (不合格) | $0.65\lt C$       |

---

定义平移量 c，使得
$$
x^{(0)}(k)'=x^{(0)}(k)-c,k=1,2,\dots,n
$$


探究两个序列在何种平移量下取得最小的后残差比：

体重-平移量：

![后残差比与平移量的关系-体重-改](https://gitee.com/koorye/picgo/raw/master/%E5%90%8E%E6%AE%8B%E5%B7%AE%E6%AF%94%E4%B8%8E%E5%B9%B3%E7%A7%BB%E9%87%8F%E7%9A%84%E5%85%B3%E7%B3%BB-%E4%BD%93%E9%87%8D-%E6%94%B9.png)

摄入能-平移量：

![](https://gitee.com/koorye/picgo/raw/master/%E5%90%8E%E6%AE%8B%E5%B7%AE%E6%AF%94%E4%B8%8E%E5%B9%B3%E7%A7%BB%E9%87%8F%E7%9A%84%E5%85%B3%E7%B3%BB-%E6%91%84%E5%85%A5%E8%83%BD.png)

则要使二者的后残差比最小，模型效果最好，取体重序列的偏移量 c=0.77，摄入能序列的偏移量 c=-10。

使用 GM(1,1) 模型进行灰色预测的结果如下图所示，其中蓝色点代表体重序列，珊瑚色点代表摄入能序列。

![灰色预测结果-改](https://gitee.com/koorye/picgo/raw/master/%E7%81%B0%E8%89%B2%E9%A2%84%E6%B5%8B%E7%BB%93%E6%9E%9C-%E6%94%B9.png)

尽管二者的后残差比均小于 0.35，表示模型良好，然而观察发现，体重序列的拟合效果好，摄入能序列的拟合效果则欠佳。

通过 GM(1,1) 模型得到的体重比例序列预测方程如下：
$$
R_W(20-T)=(0.23-0.7837)(1-e^{0.3115})e^{-0.3115\frac{25 - T}{5}} \\
=0.2024e^{0.0623T-1.5575},T=0,5,10,\dots
$$
其中 $R_W$ 表示未经过平移修正的体重比例。

修正后的体重比例 $R_W'$ 为
$$
R_W'(T)=R_W'(T)+0.77,T=0,1,2,\dots
$$
得到最终方程
$$
R_W'(T)=0.2024e^{0.0623T-1.5575}+0.77,T=0,1,2,\dots
$$
通过该方程可以解出体重比例 $R_W$ 与温度 $T$ 的关系，记
$$
R_W=f_1(T)
$$
由于灰色预测模型对摄入能的拟合效果较差，观察发现点的分布近似对数关系，尝试使用对数和 S 曲线拟合，结果如下图所示：

![回归](https://gitee.com/koorye/picgo/raw/master/%E5%9B%9E%E5%BD%92.png)

| Equation    | R  Square | F       | Sig  | Constant | b1    |
| ----------- | --------- | ------- | ---- | -------- | ----- |
| Logarithmic | .967      | 115.996 | .000 | 1.023    | .263  |
| S           | .967      | 115.663 | .000 | .448     | -.453 |

二者的 $\text{R-Square}$ 相同，对数回归的 $F$ 比 S 曲线回归更大，故对数回归的效果更好。

得到摄入能比例 $R_E$ 与温度 T 的关系为
$$
R_E=1.023+0.263\ln{\frac{25-T}{5}}
$$
记
$$
R_E=f_2(T)
$$
则龙的体重和能量消耗与温度的关系满足上述方程 f1 和 f2.

在不同热量带中，龙的体重和能量消耗的变化如下图所示，其中红色代表热带、绿色代表温带、蓝色代表寒带：

![体重-摄入能与温度的关系](https://gitee.com/koorye/picgo/raw/master/%E4%BD%93%E9%87%8D-%E6%91%84%E5%85%A5%E8%83%BD%E4%B8%8E%E6%B8%A9%E5%BA%A6%E7%9A%84%E5%85%B3%E7%B3%BB.png)